---
kind: pipeline
name: default
steps:
  # Build the blobstash binary and run the unit test suite
  - name: build_and_test
    image: golang:latest
    commands:
      - go install -mod=vendor
      - mkdir bin
      - cp -r $GOPATH/bin/blobstash bin/blobstash
      - go test -v -mod=vendor ./...

  # Integration tests against a running instance with blobstash-python
  - name: integration_test
    image: python:3
    commands:
      - pip install git+https://github.com/tsileo/blobstash-python.git
      # FIXME(tsileo): import the new tests from blobstash-base
      # - python3 integration_tests/blobstore_kvstore.py
      - export PATH=$PATH:`pwd`/bin
      - python3 integration_tests/docstore.py
---
kind: signature
hmac: 96abab411b8342e8258b7e99b8e3f995e5978665d081ee32a4439d9d7eda2268

...
