---
kind: pipeline
name: default
steps:
  # Build the blobstash binary
  - name: build
    image: golang:latest
    commands:
      - go install -mod=vendor
      - mkdir bin
      - cp -r $GOPATH/bin/blobstash bin/blobstash

  # Run the unit test suite
  - name: test
    image: golang:latest
    commands:
      - go test -v -mod=vendor ./...


  # Integration tests against a running instance with blobstash-python
  - name: integration_test
    image: python:3
    commands:
      - pip install git+https://github.com/tsileo/blobstash-python.git
      # FIXME(tsileo): import the new tests from blobstash-base
      # - python3 integration_tests/blobstore_kvstore.py
      - export PATH=$PATH:`pwd`/bin
      - python3 integration_tests/docstore.py
---
kind: signature
hmac: c550717508bd59b490583b47f4e1e558b65112a09cc0599a2e6c1a12b482896f

...
